// ----------------------------------------------------------------------------// [MM1 - Massenpanik]//       Java Source File: DragPanel.java//                  $Date: 2004/01/17 13:57:11 $//              $Revision: 1.3 $// ----------------------------------------------------------------------------package b12.panik.ui;import java.awt.*;import java.awt.event.ComponentAdapter;import java.awt.event.ComponentEvent;import javax.swing.JPanel;import javax.swing.JScrollPane;import b12.panik.ui.util.RoundBorder;import b12.panik.util.Logging;class DragPanel extends JPanel {    JPanel componentPanel;    DragPanel() {        super(new GridBagLayout());        GridBagConstraints gbc = new GridBagConstraints();        gbc.gridx = 0;        gbc.gridx = 0;        gbc.anchor = GridBagConstraints.CENTER;        gbc.fill = GridBagConstraints.NONE;        Dimension dimAvailable = new Dimension(300, 100);        setPreferredSize(dimAvailable);        setBorder(new RoundBorder("Drag Me"));        setOpaque(false); //in order to see border of panel        // component panel        componentPanel = new ComponentPanel();        componentPanel.setBackground(IConstants.COLOR_TRACKS_PANEL);                //        // scroll pane        final JScrollPane scroll = new JScrollPane(componentPanel);        scroll.setBorder(null);        scroll.setMinimumSize(new Dimension(140, 80));        this.addComponentListener(new ComponentAdapter() {            /** @see ComponentAdapter#componentResized(ComponentEvent) */            public void componentResized(ComponentEvent e) {                Dimension size = DragPanel.this.getSize();                size.width -= 20;                size.height -= 40;                scroll.setMinimumSize(size);                scroll.setMaximumSize(size);            }        });                add(scroll, gbc);    }    /** Resets this panel to an initial state */    void reset() {        componentPanel.removeAll();        validate();    }        Component addTrackLabel(TrackLabel tl) {        String label = tl.getText();        if ((label == null) || (label.trim().length() == 0)) {            label = "No name";            tl.setText(label);        }        Component c = componentPanel.add(tl);        validate();        Logging.fine("Tracklabel now holds " + componentPanel.getComponentCount() + " label(s).");        return c;    }    class ComponentPanel extends JPanel {        boolean layoutChanged;        /** @see java.awt.Container#add(java.awt.Component) */        public Component add(Component comp) {            if (!layoutChanged) {                if (getComponentCount() > 4) {                    setLayout(new GridLayout(0, 4));                    layoutChanged = true;                }            }            return super.add(comp);        }    }}